{"version":3,"sources":["webpack://FloatSidebar/webpack/universalModuleDefinition","webpack://FloatSidebar/webpack/bootstrap","webpack://FloatSidebar/./src/constants/fsmStates.js","webpack://FloatSidebar/./src/constants/fsmTransitions.js","webpack://FloatSidebar/./src/constants/fsmActions.js","webpack://FloatSidebar/./src/utils/createFSM.js","webpack://FloatSidebar/./src/utils/rAFThrottle.js","webpack://FloatSidebar/./src/utils/createDimensionObserver.js","webpack://FloatSidebar/./src/index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","STATE_START","STATE_TOP_FIXED","STATE_UNFIXED","STATE_BOTTOM_FIXED","STATE_FINISH","fsmTransitions","_defineProperty","_STATE_START$STATE_TO","to","when","isSideInnerFitsPath","viewportTop","sideInnerHeight","finishPoint","isSideInnerFitsViewport","viewportBottom","sideInnerBottom","bottomSpacing","startPoint","topSpacing","scrollDirection","sideInnerTop","fsmActions","fsmActions_defineProperty","fsmActions_STATE_START$STATE_TO","_ref","$sideInner","style","position","top","bottom","_ref2","_ref3","_ref4","_ref5","utils_createFSM","actions","transitions","currentState","initialState","findTransitionFor","_len","arguments","length","args","Array","_key","find","every","condition","performTransition","newState","apply","utils_rAFThrottle","callback","requestId","requestAnimationFrame","computeViewportDimensions","$viewport","height","clientHeight","innerHeight","scrollTop","pageYOffset","computeElementDimensions","$element","rect","getBoundingClientRect","utils_createDimensionObserver","onChange","$relative","$sideOuter","prevDimensions","computeDimensions","dim$viewport","dim$sideInner","dim$sideOuter","dim$relative","pathHeight","sideOuterHeight","Math","max","tick","dimensions","start","addEventListener","stop","removeEventListener","__webpack_exports__","options","viewport","sidebar","sidebarInner","firstElementChild","relative","fsm","dimensionObserver","transition","updateSideOuterHeight","abs","willChange","width","transform","forceUpdate","destroy"],"mappings":"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","file":"float-sidebar.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"FloatSidebar\"] = factory();\n\telse\n\t\troot[\"FloatSidebar\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export const STATE_START        = 'START';\nexport const STATE_TOP_FIXED    = 'TOP_FIXED';\nexport const STATE_UNFIXED      = 'UNFIXED';\nexport const STATE_BOTTOM_FIXED = 'BOTTOM_FIXED';\nexport const STATE_FINISH       = 'FINISH';","import {\n  STATE_START,\n  STATE_TOP_FIXED,\n  STATE_UNFIXED,\n  STATE_BOTTOM_FIXED,\n  STATE_FINISH\n} from './fsmStates.js';\n\nexport default {\n  [STATE_START]: [\n    {\n      to: STATE_FINISH,\n      when: (d) => [\n        d.isSideInnerFitsPath === true,\n        d.viewportTop + d.sideInnerHeight >= d.finishPoint\n      ]\n    },\n    {\n      to: STATE_BOTTOM_FIXED,\n      when: (d) => [\n        d.isSideInnerFitsPath === true,\n        d.isSideInnerFitsViewport === false,\n        d.viewportBottom >= d.sideInnerBottom + d.bottomSpacing\n      ],\n    },\n    {\n      to: STATE_TOP_FIXED,\n      when: (d) => [\n        d.isSideInnerFitsPath === true,\n        d.isSideInnerFitsViewport === true,\n        d.viewportTop >= d.startPoint - d.topSpacing\n      ]\n    }\n  ],\n\n  [STATE_TOP_FIXED]: [\n    {\n      to: STATE_START,\n      when: (d) => [d.isSideInnerFitsPath === false],\n    },\n    {\n      to: STATE_START,\n      when: (d) => [d.viewportTop <= d.startPoint - d.topSpacing]\n    },\n    {\n      to: STATE_FINISH,\n      when: (d) => [d.sideInnerBottom >= d.finishPoint]\n    },\n    {\n      to: STATE_UNFIXED,\n      when: (d) => [\n        d.scrollDirection === 'down',\n        d.isSideInnerFitsViewport === false\n      ]\n    },\n  ],\n\n  [STATE_UNFIXED]: [\n    {\n      to: STATE_START,\n      when: (d) => [d.isSideInnerFitsPath === false],\n    },\n    {\n      to: STATE_TOP_FIXED,\n      when: (d) => [d.viewportTop <= d.sideInnerTop - d.topSpacing]\n    },\n    {\n      to: STATE_TOP_FIXED,\n      when: (d) => [\n        d.isSideInnerFitsViewport === true,\n        d.viewportBottom >= d.sideInnerBottom + d.bottomSpacing\n      ]\n    },\n    {\n      to: STATE_BOTTOM_FIXED,\n      when: (d) => [\n        d.isSideInnerFitsViewport === false,\n        d.viewportBottom >= d.sideInnerBottom + d.bottomSpacing\n      ]\n    }\n  ],\n\n  [STATE_BOTTOM_FIXED]: [\n    {\n      to: STATE_START,\n      when: (d) => [d.isSideInnerFitsPath === false],\n    },\n    {\n      to: STATE_UNFIXED,\n      when: (d) => [d.scrollDirection === 'up']\n    },\n    {\n      to: STATE_TOP_FIXED,\n      when: (d) => [d.isSideInnerFitsViewport === true,]\n    },\n    {\n      to: STATE_FINISH,\n      when: (d) => [d.sideInnerBottom >= d.finishPoint]\n    }\n  ],\n\n  [STATE_FINISH]: [\n    {\n      to: STATE_START,\n      when: (d) => [d.isSideInnerFitsPath === false],\n    },\n    {\n      to: STATE_BOTTOM_FIXED,\n      when: (d) => [\n        d.sideInnerBottom + d.bottomSpacing <= d.finishPoint,\n        d.viewportBottom <= d.finishPoint\n      ]\n    },\n    {\n      to: STATE_TOP_FIXED,\n      when: (d) => [d.viewportTop <= d.sideInnerTop - d.topSpacing]\n    }\n  ]\n}\n","import {\n  STATE_START,\n  STATE_TOP_FIXED,\n  STATE_UNFIXED,\n  STATE_BOTTOM_FIXED,\n  STATE_FINISH\n} from './fsmStates.js';\n\nexport default {\n  [STATE_START]: (d, { $sideInner }) => {\n    $sideInner.style.position = 'absolute';\n    $sideInner.style.top      = '0';\n    $sideInner.style.bottom   = 'auto';\n  },\n\n  [STATE_TOP_FIXED]: (d, { $sideInner }) => {\n    $sideInner.style.position = 'fixed';\n    $sideInner.style.top      = `${d.topSpacing}px`;\n    $sideInner.style.bottom   = 'auto';\n  },\n\n  [STATE_UNFIXED]: (d, { $sideInner }) => {\n    $sideInner.style.position = 'absolute';\n    $sideInner.style.top      = `${d.sideInnerTop - d.startPoint}px`;\n    $sideInner.style.bottom   = 'auto';\n  },\n\n  [STATE_BOTTOM_FIXED]: (d, { $sideInner }) => {\n    $sideInner.style.position = 'fixed';\n    $sideInner.style.top      = 'auto';\n    $sideInner.style.bottom   = `${d.bottomSpacing}px`;\n  },\n\n  [STATE_FINISH]: (d, { $sideInner }) => {\n    $sideInner.style.position = 'absolute';\n    $sideInner.style.top      = 'auto';\n    $sideInner.style.bottom   = '0';\n  }\n}\n","function createFSM({ actions, transitions, initialState }) {\n  let currentState = initialState;\n\n  let findTransitionFor = (...args) => {\n    return transitions[currentState]\n      .find(({ when }) => {\n        return when(...args).every((condition) => condition);\n      });\n  }\n\n  let performTransition = ({ to: newState }) => (...args) => {\n    currentState = newState;\n\n    actions[newState](...args);\n  }\n\n  return { findTransitionFor, performTransition };\n}\n\nexport default createFSM;","function rAFThrottle(callback) {\n  let requestId;\n\n  return () => {\n    if (!requestId) {\n      requestId = requestAnimationFrame(() => {\n        requestId = null;\n        callback();\n      });\n    }\n  }\n}\n\nexport default rAFThrottle;","import rAFThrottle from './rAFThrottle';\n\nlet computeViewportDimensions = ($viewport) => {\n  let height = $viewport.clientHeight || $viewport.innerHeight;\n  let top    = $viewport.scrollTop    || $viewport.pageYOffset;\n  let bottom = top + height;\n\n  return { top, bottom, height }\n}\n\nlet computeElementDimensions = ($element, viewportTop) => {\n  let rect = $element.getBoundingClientRect();\n\n  return {\n    top:    rect.top    + viewportTop,\n    bottom: rect.bottom + viewportTop,\n    height: rect.height\n  }\n}\n\nfunction createDimensionObserver(onChange, {\n  $viewport,\n  $relative,\n  $sideInner,\n  $sideOuter,\n  topSpacing,\n  bottomSpacing\n}) {\n  let prevDimensions = {};\n\n  let computeScrollDirection = (viewportTop) => (\n    prevDimensions.viewportTop < viewportTop ? 'down' :\n    prevDimensions.viewportTop > viewportTop ? 'up'   : 'notChanged'\n  )\n\n  let computeDimensions = () => {\n    let dim$viewport  = computeViewportDimensions($viewport);\n    let dim$sideInner = computeElementDimensions($sideInner, dim$viewport.top);\n    let dim$sideOuter = computeElementDimensions($sideOuter, dim$viewport.top);\n    let dim$relative  = computeElementDimensions($relative,  dim$viewport.top);\n\n    let scrollDirection = computeScrollDirection(dim$viewport.top);\n\n    let startPoint  = dim$sideOuter.top;\n    let finishPoint = dim$relative.bottom;\n\n    let pathHeight  = finishPoint - startPoint;\n\n    let isSideInnerFitsViewport = dim$sideInner.height + topSpacing + bottomSpacing < dim$viewport.height;\n    let isSideInnerFitsPath     = dim$sideInner.height < pathHeight;\n\n    let sideOuterHeight = Math.max(dim$sideInner.height, pathHeight);\n\n    return {\n      startPoint,\n      finishPoint,\n      topSpacing,\n      bottomSpacing,\n      scrollDirection,\n      isSideInnerFitsPath,\n      isSideInnerFitsViewport,\n\n      sideOuterHeight: sideOuterHeight,\n\n      viewportTop:    dim$viewport.top,\n      viewportBottom: dim$viewport.bottom,\n\n      sideInnerTop:    dim$sideInner.top,\n      sideInnerBottom: dim$sideInner.bottom,\n      sideInnerHeight: dim$sideInner.height,\n    }\n  }\n\n  let tick = rAFThrottle(() => {\n    let dimensions = computeDimensions();\n\n    onChange(prevDimensions, dimensions);\n\n    prevDimensions = dimensions;\n  });\n\n  let start = () => {\n    $viewport.addEventListener('scroll', tick);\n    $viewport.addEventListener('resize', tick);\n\n    tick();\n  }\n\n  let stop = () => {\n    $viewport.removeEventListener('scroll', tick);\n    $viewport.removeEventListener('resize', tick);\n  }\n\n  return { start, stop, tick };\n}\n\nexport default createDimensionObserver;","import fsmTransitions from './constants/fsmTransitions';\nimport fsmActions     from './constants/fsmActions';\nimport * as fsmStates from './constants/fsmStates';\n\nimport createFSM               from './utils/createFSM';\nimport createDimensionObserver from './utils/createDimensionObserver';\n\nfunction FloatSidebar(options) {\n  let $viewport  = options.viewport || window;\n  let $sideOuter = options.sidebar;\n  let $sideInner = options.sidebarInner || $sideOuter.firstElementChild;\n  let $relative  = options.relative;\n\n  let topSpacing    = options.topSpacing    || 0;\n  let bottomSpacing = options.bottomSpacing || 0;\n\n  let fsm = createFSM({\n    actions:      fsmActions,\n    transitions:  fsmTransitions,\n    initialState: fsmStates.STATE_START\n  });\n\n  let dimensionObserver = createDimensionObserver(\n    (prevDimensions, dimensions) => {\n      let transition = fsm.findTransitionFor(dimensions);\n\n      if (transition) {\n        fsm.performTransition(transition)(dimensions, {\n          $sideInner,\n          $sideOuter,\n          $relative\n        });\n      }\n\n      updateSideOuterHeight(prevDimensions, dimensions);\n    },\n\n    {\n      $viewport,\n      $sideOuter,\n      $sideInner,\n      $relative,\n      topSpacing,\n      bottomSpacing\n    }\n  )\n\n  let updateSideOuterHeight = (prevDimensions, dimensions) => {\n    let isHeightChanged = Math.abs(\n      (prevDimensions.sideOuterHeight || 0) - dimensions.sideOuterHeight\n    ) >= 1;\n\n    if (isHeightChanged) {\n      $sideOuter.style.height = `${dimensions.sideOuterHeight}px`;\n    }\n  }\n\n  let forceUpdate = () => {\n    dimensionObserver.tick();\n  }\n\n  let destroy = () => {\n    dimensionObserver.stop();\n  }\n\n  let init = () => {\n    $sideOuter.style.willChange = 'height';\n    $sideInner.style.width      = 'inherit';\n    $sideInner.style.transform  = 'translateZ(0)';\n    $sideInner.style.willChange = 'transform';\n\n    dimensionObserver.start();\n  }\n\n  requestAnimationFrame(init);\n\n  return { forceUpdate, destroy };\n}\n\nexport default FloatSidebar;\n"],"sourceRoot":""}